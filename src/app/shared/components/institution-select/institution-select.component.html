<div class="institution-select-container">
    <label *ngIf="label" class="block text-sm font-medium text-gray-700 mb-1">{{ label }}</label>
    <div class="relative">
        <div class="search-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="#9CA3AF">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
        </div>

        <input type="text" [formControl]="control" [placeholder]="placeholder"
            class="form-input with-icon w-full rounded-md border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500"
            [class.is-invalid]="control.invalid && control.touched" (blur)="onBlur()" (focus)="onFocus()">

        <div *ngIf="isLoading" class="loading-wrapper">
            <svg class="spinner" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                </path>
            </svg>
        </div>

        <ul *ngIf="showDropdown && results.length > 0" class="dropdown-list">
            <li *ngFor="let item of results" (click)="selectItem(item)">
                {{ item.nombre }}
            </li>
        </ul>

    </div>

    <div *ngIf="control.touched && control.invalid" class="error-message">
        Este campo es requerido.
    </div>
</div>